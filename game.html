<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>block breaker</title>
  <style media="screen">
    canvas {
      border: 1px black solid;
    }
  </style>
  <script src='engine.js'></script>
  <script src='ball.js'></script>
  <script src='paddle.js'></script>
  <script src='block.js'></script>
  <script src='utils.js'></script>
</head>
<body>
  <canvas id="id-canvas" width="400" height="300"></canvas>
  <script>
    var main = function() { 
      var game = Engine()

      var paddle = Paddle()
      var ball = Ball()

      var blocks = []
      for (var i = 0; i < 3; i++) {
        var b = Block()
        b.x = i * 100
        b.y = 50
        blocks.push(b)
      }

      game.registerAction('a', function() {
       paddle.moveLeft()
     })
      game.registerAction('d', function() {
       paddle.moveRight()
     })
      game.registerAction('f', function() {
        ball.fire()
      })

      game.update = function() {
        if (game.paused) {
          return
        }

        ball.move()
        if (paddle.collide(ball)) {
          ball.rebound()
        }
        for (var i = 0; i < blocks.length; i++) {
          if (blocks[i].collide(ball)) {
            blocks[i].kill()
            ball.rebound()
          }  
        }

      }

      game.draw = function() {
        game.drawImage(paddle)
        game.drawImage(ball)
        for (var i = 0; i < blocks.length; i++) {
          if (blocks[i].alive) {
            game.drawImage(blocks[i])
          }
        }

      }
    }

    main()
  </script>
</body>
</html>